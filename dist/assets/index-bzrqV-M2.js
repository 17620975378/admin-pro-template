import{Y,k as S,e as j,r as g,f as R,s as z,Z,K as $,o as f,c as E,g as t,w as a,t as n,E as D,h as q,_ as J,i as k,y as F,n as K,l as A,q as G,$ as M,a0 as Q,A as U,I,O,b as X,a1 as ee,a2 as te,H as le,u as ae,L as oe,a3 as ne}from"./vendor-CjuydzvB.js";const B=i=>"";var re={VITE_APP_API_BASEURL:"/api",VITE_APP_MOCK_BASEURL:"/mock/api",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const V=Y.create({baseURL:re.VITE_APP_USE_MOCK?"/mock/api":"/api",timeout:15e3});V.interceptors.request.use(i=>i,i=>Promise.reject(i));V.interceptors.response.use(i=>i.status===200?i.data.code!==0?(S({type:"error",message:i.data.messages}),Promise.reject(i.data)):i.data:(S({message:B(i.status),type:"error"}),i),i=>{const{response:d}=i;if(d)return S({message:B(d.status),type:"error"}),Promise.reject(d.data);S({message:"网络连接异常,请稍后再试!",type:"error"})});function he(i){return V({url:"/login",method:"post",data:i})}function se(){return V({url:"/getUserList",method:"get"})}function ue(){return V({url:"/projects",method:"get"})}const ie={class:"wrap-content"},de=j({__name:"index",setup(i){let d=g([]);const c=()=>{ue().then(u=>{d.value=u.data,e.dataCount=u.data.length})};R(()=>{c()});let e=z({title:"",introduce:"",currentPage:1,pageSize:5,dataCount:0});const h=()=>{console.log(d.value);let u=[];e.title||e.introduce?(e.title&&(u=d.value.filter(_=>_.title.indexOf(e.title)!==-1)),e.introduce&&(u=d.value.filter(_=>_.introduce.indexOf(e.introduce)!==-1))):u=d.value,d.value=u,e.dataCount=u.length,e.currentPage=1};let m=Z(()=>d.value.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize));const s=u=>{e.pageSize=u},x=u=>{e.currentPage=u};return $([()=>e.title,()=>e.introduce],()=>{!e.title&&!e.introduce&&c()}),(u,_)=>{const N=F,b=K,r=A,l=D,p=G,v=q,L=J;return f(),E("div",ie,[t(l,{inline:"",model:n(e),class:"search-form"},{default:a(()=>[t(b,{label:"项目名称"},{default:a(()=>[t(N,{modelValue:n(e).title,"onUpdate:modelValue":_[0]||(_[0]=y=>n(e).title=y),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1}),t(b,{label:"项目详情"},{default:a(()=>[t(N,{modelValue:n(e).introduce,"onUpdate:modelValue":_[1]||(_[1]=y=>n(e).introduce=y),placeholder:"请输入项目详情"},null,8,["modelValue"])]),_:1}),t(b,null,{default:a(()=>[t(r,{type:"primary",onClick:_[2]||(_[2]=y=>h())},{default:a(()=>[k("查询")]),_:1})]),_:1})]),_:1},8,["model"]),t(v,{data:n(m),style:{width:"100%"},border:""},{default:a(()=>[t(p,{prop:"id",label:"编号",width:"180"}),t(p,{prop:"title",label:"名称",width:"180"}),t(p,{prop:"introduce",label:"项目详情"})]),_:1},8,["data"]),t(L,{layout:"prev, pager, next, sizes",total:n(e).dataCount,"page-size":n(e).pageSize,"page-sizes":[5,10,20],onSizeChange:s,onCurrentChange:x},null,8,["total","page-size"])])}}}),be=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"}));function ce(){return V({url:"/getRole",method:"get"})}const me={class:"dialog-footer"},_e=j({__name:"index",setup(i){let d=g([]),c=g(!1),e=g([]),h=g([]),m=z({id:0,nickName:"",role:[]}),s=z({nickName:"",role:0});R(()=>{x(),u()});const x=()=>{se().then(r=>{e.value=r.data,h.value=r.data})},u=()=>{ce().then(r=>{d.value=r.data})},_=()=>{let r=[];e.value=h.value,s.nickName||s.role?(s.nickName&&(r=e.value.filter(l=>l.nickName.indexOf(s.nickName)!==-1)),s.role&&(r=s.nickName?r:e.value,r=r.filter(l=>l.role.find(p=>p.role===s.role)))):r=e.value,e.value=r};$([()=>s.nickName,()=>s.role],()=>{s.nickName===""&&s.role===0&&x()});const N=r=>{c.value=!0,Object.assign(m,{...r,role:r.role.map(l=>l.role)})},b=()=>{c.value=!1;let r=e.value.find(l=>l.id===m.id);r.nickName=m.nickName,r.role=[],d.value.forEach(l=>{m.role.find(p=>p===l.roleId)&&r.role.push({role:l.roleId,roleName:l.roleName})})};return(r,l)=>{const p=F,v=K,L=ee,y=te,C=A,T=D,P=G,H=q,W=Q;return f(),E("div",null,[t(T,{inline:"",model:n(s),class:"search-form"},{default:a(()=>[t(v,{label:"用户名称"},{default:a(()=>[t(p,{modelValue:n(s).nickName,"onUpdate:modelValue":l[0]||(l[0]=o=>n(s).nickName=o),placeholder:"请输入用户名称",style:{width:"180px"},clearable:""},null,8,["modelValue"])]),_:1}),t(v,{label:"用户角色"},{default:a(()=>[t(y,{modelValue:n(s).role,"onUpdate:modelValue":l[1]||(l[1]=o=>n(s).role=o),style:{width:"180px"}},{default:a(()=>[(f(),U(L,{key:0,label:"全部",value:0})),(f(!0),E(I,null,O(n(d),o=>(f(),U(L,{key:o.roleId,label:o.roleName,value:o.roleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:a(()=>[t(C,{type:"primary",onClick:_},{default:a(()=>[k("查询")]),_:1})]),_:1})]),_:1},8,["model"]),t(H,{data:n(e),style:{width:"100%"},border:"",class:"content-table"},{default:a(()=>[t(P,{label:"编号",prop:"id",width:"100"}),t(P,{label:"用户名称",prop:"nickName",width:"160"}),t(P,{label:"用户角色",prop:"role"},{default:a(o=>[(f(!0),E(I,null,O(o.row.role,w=>(f(),U(C,{key:w.role,type:"primary",size:"small"},{default:a(()=>[k(le(w.roleName),1)]),_:2},1024))),128))]),_:1}),t(P,{label:"操作",width:"160",align:"center"},{default:a(o=>[t(C,{type:"primary",size:"small",text:!0,onClick:w=>N(o.row)},{default:a(()=>[k("编辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(W,{modelValue:n(c),"onUpdate:modelValue":l[5]||(l[5]=o=>M(c)?c.value=o:c=o),class:"edit-dialog",title:"编辑用户信息"},{footer:a(()=>[X("div",me,[t(C,{onClick:l[4]||(l[4]=o=>M(c)?c.value=!1:c=!1)},{default:a(()=>[k("取 消")]),_:1}),t(C,{type:"primary",onClick:b},{default:a(()=>[k("确 定")]),_:1})])]),default:a(()=>[t(T,{class:"edit-dialog-form",data:n(m)},{default:a(()=>[t(v,{label:"用户名称"},{default:a(()=>[t(p,{modelValue:n(m).nickName,"onUpdate:modelValue":l[2]||(l[2]=o=>n(m).nickName=o),placeholder:"请输入用户名称",style:{width:"180px"},clearable:""},null,8,["modelValue"])]),_:1}),t(v,{label:"用户角色"},{default:a(()=>[t(y,{modelValue:n(m).role,"onUpdate:modelValue":l[3]||(l[3]=o=>n(m).role=o),style:{width:"180px"},multiple:"",placeholder:"请选择用户角色"},{default:a(()=>[(f(!0),E(I,null,O(n(d),o=>(f(),U(L,{key:o.roleId,label:o.roleName,value:o.roleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}}),ve=Object.freeze(Object.defineProperty({__proto__:null,default:_e},Symbol.toStringTag,{value:"Module"}));function pe(){return V({url:"/getAuthList",method:"get"})}const fe=j({__name:"index",setup(i){const d=ae(),c=oe(),{query:e}=c;let h=g([]);const m=g(),s=g([]);e.authList&&(s.value=e.authList),R(()=>{pe().then(u=>{h.value=u.data})});const x=()=>{const u=m.value.getCheckedNodes();console.log(u),S({type:"success",message:"修改权限成功"}),d.push("/role")};return(u,_)=>{const N=ne,b=A;return f(),E("div",null,[t(N,{ref_key:"treeRef",ref:m,style:{"max-width":"600px"},data:n(h),"show-checkbox":"","node-key":"authId","check-strictly":!0,"default-checked-keys":s.value,props:{label:"name",children:"authList"}},null,8,["data","default-checked-keys"]),t(b,{type:"primary",size:"small",style:{margin:"10px 0 0 20px"},onClick:x},{default:a(()=>[k("修改权限")]),_:1})])}}}),ye=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"}));export{ve as a,ye as b,ce as g,be as i,he as u};
